using UnityEngine;
using System.Collections;

public class Flare : MonoBehaviour {
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------

    public bool cam_orientation = false;

    public bool stroboskob_fx = false;

    public float flare_intensity = 1.0f;
    //--------------------------------
    float flare_xrot;
    float flare_zrot;

    float strobo_interval;
    float strobo_count;
    bool  strobo_mode;
    float size;

//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
//
// Init 
//
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
void Start() 
{
    flare_xrot = gameObject.transform.eulerAngles.x;
    flare_zrot = gameObject.transform.eulerAngles.z;

    strobo_mode = false;
    strobo_interval = Random.Range(0.8f, 1.5f);
    strobo_count = 0.0f;

}
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
//
// Update
//
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
void Update()
{

    //-- set cam orientation
    if(cam_orientation == true)
        gameObject.transform.eulerAngles = new Vector3 (flare_xrot, (Camera.main.transform.eulerAngles.y + 90.0f), flare_zrot);

    //-- do strobo fx
    if(stroboskob_fx == true)
    {
        //-- pause interval
        if(strobo_mode == false)    
        {
            strobo_count += Time.deltaTime * 1.5f;               
            if(strobo_count >= strobo_interval)
            {
                strobo_count = 2.0f;
                strobo_mode = true;
                size = 3.0f;
            }
            else
                size = 0.0f;
        }
        //-- flash down
        else if(strobo_mode == true)
        {
            size -= Time.deltaTime * 5.0f;
            if(size < 0.0f)
            {
                size = 0.0f;
                strobo_count = 0.0f;
                strobo_mode = false;
            }
        }
        transform.localScale = new Vector3(size, size, size);
    }

}
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------
}
